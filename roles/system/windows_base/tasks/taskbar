---
- name: Configure Taskbar
  become: yes
  become_method: runas
  become_user: "{{ user }}"
  block:
  - name: Remove Search from Taskbar.
    ansible.windows.win_regedit:
      path: HKCU:\Software\Microsoft\Windows\CurrentVersion\Search
      name: SearchboxTaskbarMode
      data: 0
      type: dword

  - name: Remove Copilot from Taskbar.
    ansible.windows.win_regedit:
      path: HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
      name: ShowCopilotButton
      data: 0
      type: dword

  - name: Remove Store from Taskbar
    ansible.windows.win_regedit:
      path: HKCU:\Software\Policies\Microsoft\Windows\Explorer
      name: NoPinningStoreToTaskbar
      data: 1
      type: dword

  - name: Unpin 'People' from Taskbar.
    ansible.windows.win_regedit:
      path: HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\People
      name: PeopleBand
      data: 0
      type: dword

  - name: Unpin 'News and Interests' from Taskbar.
    ansible.windows.win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Windows Feeds
      name: EnableFeeds
      data: 0
      type: dword
      state: present
